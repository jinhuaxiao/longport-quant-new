# æ‰¹é‡å–æ¶ˆè®¢å• - å¿«é€Ÿå¼€å§‹æŒ‡å—

## ğŸ¯ æ‚¨çš„æƒ…å†µ

æ ¹æ®æŸ¥è¯¢ç»“æœï¼Œ**paper_001** è´¦å·ä¸­æœ‰ï¼š
- **537 ä¸ªå¯å–æ¶ˆçš„ GTC è®¢å•**ï¼ˆæ’¤å•å‰æœ‰æ•ˆï¼‰
- å¤§éƒ¨åˆ†æ˜¯ `VarietiesNotReported` çŠ¶æ€ï¼ˆå“ç§æœªæŠ¥å‘Šï¼‰
- è®¢å•åˆ›å»ºæ—¶é—´ï¼š10æœˆ28æ—¥è‡³11æœˆ2æ—¥
- æ¶‰åŠæ ‡çš„ï¼š1398.HK, 883.HK, AAPL.US, AMZN.US, NVDU.US ç­‰

## ğŸ“‹ æ¨èæ“ä½œæµç¨‹

### æ­¥éª¤1ï¼šé¢„è§ˆè®¢å•ï¼ˆå¿…é¡»å…ˆåšï¼ï¼‰

```bash
python scripts/cancel_old_orders.py --account paper_001 --dry-run
```

è¿™ä¼šæ˜¾ç¤ºï¼š
- å°†è¦å–æ¶ˆçš„è®¢å•æ€»æ•°ï¼š537 ä¸ª
- æŒ‰æ ‡çš„åˆ†ç»„çš„è®¢å•åˆ—è¡¨
- æ¯ä¸ªè®¢å•çš„è¯¦ç»†ä¿¡æ¯ï¼ˆè®¢å•å·ã€æ ‡çš„ã€æ•°é‡ã€ä»·æ ¼ã€çŠ¶æ€ï¼‰

### æ­¥éª¤2ï¼šç¡®è®¤å¹¶æ‰§è¡Œå–æ¶ˆ

å¦‚æœç¡®è®¤æ— è¯¯ï¼Œæ‰§è¡Œå®é™…å–æ¶ˆï¼š

```bash
python scripts/cancel_old_orders.py --account paper_001 --keep-days 1
```

ç³»ç»Ÿä¼šè¦æ±‚ç¡®è®¤ï¼š
```
âš ï¸  è­¦å‘Šï¼šå³å°†å–æ¶ˆ 537 ä¸ªè®¢å•ï¼

è¯·ä»”ç»†ç¡®è®¤ä»¥ä¸Šè®¢å•åˆ—è¡¨ã€‚æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼

ç¡®è®¤è¦ç»§ç»­å—ï¼Ÿ(yes/no):
```

è¾“å…¥ `yes` ç¡®è®¤æ‰§è¡Œã€‚

### æ­¥éª¤3ï¼šæŸ¥çœ‹å–æ¶ˆç»“æœ

è„šæœ¬ä¼šæ˜¾ç¤ºè¯¦ç»†çš„å–æ¶ˆç»“æœï¼š
```
ğŸ“Š å–æ¶ˆç»“æœç»Ÿè®¡ï¼š

  æŸ¥è¯¢åˆ°çš„è®¢å•æ•°: 1542
  å¯å–æ¶ˆè®¢å•æ•°:   537
  æˆåŠŸå–æ¶ˆ:       537  â† æˆåŠŸæ•°é‡
  å–æ¶ˆå¤±è´¥:       0    â† å¤±è´¥æ•°é‡
```

## ğŸ” æŸ¥è¯¢ç‰¹å®šè®¢å•

å¦‚æœæƒ³æŸ¥è¯¢æŸä¸ªè®¢å•çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¾‹å¦‚æ‚¨æåˆ°çš„ `1167613655953453056`ï¼š

```bash
python scripts/check_order_detail.py --account paper_001 --order-id 1167613655953453056
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
âœ… åœ¨ä»Šæ—¥è®¢å•ä¸­æ‰¾åˆ°ï¼š

  è®¢å•ID:       1167613655953453056
  æ ‡çš„:         NVDU.US
  æ–¹å‘:         OrderSide.Sell
  æ•°é‡:         105
  ä»·æ ¼:         $117.08
  çŠ¶æ€:         OrderStatus.VarietiesNotReported
  è®¢å•ç±»å‹:     OrderType.LIT
  æœ‰æ•ˆæœŸ:       TimeInForceType.GoodTilCanceled  â† GTCè®¢å•
  è§¦å‘ä»·:       $117.67
  åˆ›å»ºæ—¶é—´:     2025-10-28 07:59:48

  å¯å–æ¶ˆ:       âœ… æ˜¯ (å½“å‰çŠ¶æ€: VarietiesNotReported)
```

## ğŸ›¡ï¸ å®‰å…¨ä¿æŠ¤

- âœ… **é¢„è§ˆæ¨¡å¼**ï¼š`--dry-run` é€‰é¡¹è®©æ‚¨å…ˆæŸ¥çœ‹ä¸æ‰§è¡Œ
- âœ… **ç¡®è®¤æç¤º**ï¼šé»˜è®¤ä¼šè¦æ±‚è¾“å…¥ `yes` ç¡®è®¤
- âœ… **çŠ¶æ€æ£€æŸ¥**ï¼šåªå–æ¶ˆå¯å–æ¶ˆçŠ¶æ€çš„è®¢å•
- âœ… **è¯¦ç»†æ—¥å¿—**ï¼šè®°å½•æ¯ä¸ªè®¢å•çš„å–æ¶ˆç»“æœ
- âœ… **é”™è¯¯å¤„ç†**ï¼šå–æ¶ˆå¤±è´¥ä¸ä¼šå½±å“å…¶ä»–è®¢å•

## ğŸ“Š å¸¸ç”¨å‘½ä»¤

```bash
# 1. é¢„è§ˆ paper_001 çš„å†å²è®¢å•
python scripts/cancel_old_orders.py --account paper_001 --dry-run

# 2. å–æ¶ˆ paper_001 çš„å†å²è®¢å•ï¼ˆåªä¿ç•™ä»Šæ—¥ï¼‰
python scripts/cancel_old_orders.py --account paper_001 --keep-days 1

# 3. å–æ¶ˆ live_001 çš„å†å²è®¢å•
python scripts/cancel_old_orders.py --account live_001 --dry-run

# 4. æŸ¥çœ‹è´¦å·æ‰€æœ‰è®¢å•çŠ¶æ€
python scripts/check_order_detail.py --account paper_001

# 5. æŸ¥è¯¢ç‰¹å®šè®¢å•è¯¦æƒ…
python scripts/check_order_detail.py --account paper_001 --order-id è®¢å•å·
```

## â“ å¸¸è§é—®é¢˜

### Q1: VarietiesNotReported æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Ÿ

**A**: è¿™æ˜¯ GTCï¼ˆæ’¤å•å‰æœ‰æ•ˆï¼‰æ¡ä»¶å•çš„å¸¸è§çŠ¶æ€ï¼Œè¡¨ç¤º"å“ç§æœªæŠ¥å‘Š"ã€‚è¿™äº›è®¢å•è™½ç„¶åˆ›å»ºäºå†å²æ—¥æœŸï¼Œä½†å› ä¸ºè®¾ç½®äº† GoodTilCanceledï¼ˆæ’¤å•å‰æœ‰æ•ˆï¼‰ï¼Œä¼šä¸€ç›´æœ‰æ•ˆç›´åˆ°è¢«æ‰‹åŠ¨å–æ¶ˆæˆ–è§¦å‘ã€‚

### Q2: ä¸ºä»€ä¹ˆè¿™äº›è®¢å•ä¼šåœ¨"ä»Šæ—¥è®¢å•"ä¸­ï¼Ÿ

**A**: GTC è®¢å•ä¼šä¸€ç›´ä¿æŒæ´»è·ƒçŠ¶æ€ï¼Œå› æ­¤ä¼šæŒç»­æ˜¾ç¤ºåœ¨"ä»Šæ—¥è®¢å•"åˆ—è¡¨ä¸­ã€‚æœ¬å·¥å…·ä¼šæ ¹æ®è®¢å•çš„**åˆ›å»ºæ—¶é—´**ï¼ˆè€Œéæ˜¾ç¤ºä½ç½®ï¼‰æ¥åˆ¤æ–­æ˜¯å¦ä¸ºå†å²è®¢å•ã€‚

### Q3: å–æ¶ˆè¿™äº›è®¢å•å®‰å…¨å—ï¼Ÿ

**A**: æ˜¯çš„ï¼Œéå¸¸å®‰å…¨ï¼š
- è¿™äº›éƒ½æ˜¯æœªæˆäº¤çš„æ¡ä»¶å•
- ä¸ä¼šå½±å“å·²æŒæœ‰çš„ä»“ä½
- å¯ä»¥éšæ—¶é‡æ–°åˆ›å»ºæ–°çš„æ­¢æŸæ­¢ç›ˆè®¢å•

### Q4: å¦‚ä½•åªå–æ¶ˆæŸä¸ªæ ‡çš„çš„è®¢å•ï¼Ÿ

**A**: ä½¿ç”¨ `--symbol` å‚æ•°ï¼š
```bash
python scripts/cancel_old_orders.py --account paper_001 --symbol NVDU.US --dry-run
```

### Q5: å–æ¶ˆåå¯ä»¥æ¢å¤å—ï¼Ÿ

**A**: ä¸å¯ä»¥ã€‚è®¢å•ä¸€æ—¦å–æ¶ˆï¼Œæ— æ³•æ¢å¤ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¼ºçƒˆå»ºè®®å…ˆä½¿ç”¨ `--dry-run` é¢„è§ˆã€‚

## ğŸš¨ æ³¨æ„äº‹é¡¹

1. **å…ˆé¢„è§ˆå†æ‰§è¡Œ**ï¼šåŠ¡å¿…å…ˆè¿è¡Œ `--dry-run` æŸ¥çœ‹è®¢å•åˆ—è¡¨
2. **ç¡®è®¤è®¢å•å†…å®¹**ï¼šæ£€æŸ¥è®¢å•æ ‡çš„ã€æ•°é‡ã€ä»·æ ¼æ˜¯å¦ç¬¦åˆé¢„æœŸ
3. **å¤‡ä»½é‡è¦ä¿¡æ¯**ï¼šå¦‚æœæœ‰é‡è¦çš„æ­¢æŸæ­¢ç›ˆä»·ä½ï¼Œå»ºè®®å…ˆè®°å½•
4. **åˆ†æ‰¹å¤„ç†**ï¼šå¦‚æœè®¢å•å¾ˆå¤šï¼Œå¯ä»¥å…ˆç”¨ `--symbol` åˆ†æ ‡çš„å¤„ç†
5. **é¿å…äº¤æ˜“æ—¶æ®µ**ï¼šå»ºè®®åœ¨éäº¤æ˜“æ—¶æ®µæ‰§è¡Œï¼Œé¿å…å½±å“å¸‚åœºæ“ä½œ

## ğŸ’¡ æ¨èåšæ³•

å¯¹äºæ‚¨çš„æƒ…å†µï¼ˆ537ä¸ªå†å²GTCè®¢å•ï¼‰ï¼Œæ¨èè¿™æ ·åšï¼š

1. **é¢„è§ˆæ‰€æœ‰è®¢å•**ï¼š
   ```bash
   python scripts/cancel_old_orders.py --account paper_001 --dry-run > orders_preview.txt
   ```
   å°†ç»“æœä¿å­˜åˆ°æ–‡ä»¶ï¼Œä»”ç»†æŸ¥çœ‹

2. **æ‰§è¡Œæ‰¹é‡å–æ¶ˆ**ï¼š
   ```bash
   python scripts/cancel_old_orders.py --account paper_001 --keep-days 1
   ```
   ç¡®è®¤åæ‰§è¡Œ

3. **éªŒè¯ç»“æœ**ï¼š
   ```bash
   python scripts/check_order_detail.py --account paper_001
   ```
   æ£€æŸ¥æ˜¯å¦è¿˜æœ‰å¯å–æ¶ˆçš„è®¢å•

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼š
1. æŸ¥çœ‹è¯¦ç»†æ–‡æ¡£ï¼š[docs/BATCH_CANCEL_ORDERS.md](docs/BATCH_CANCEL_ORDERS.md)
2. æŸ¥çœ‹æ—¥å¿—è¾“å‡ºï¼Œç¡®è®¤é”™è¯¯ä¿¡æ¯
3. æäº¤ Issue æˆ–è”ç³»æŠ€æœ¯æ”¯æŒ

---

**ç¥æ‚¨ä½¿ç”¨é¡ºåˆ©ï¼** ğŸ‰
